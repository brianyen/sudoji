<html>
<body>
<h1 id="livesLeft">Lives Left: 3</h1>

<button class="difficulty" type="button" onclick="removeNumbers(grid, easy)"> Easy </button>
<button class="difficulty" type="button" onclick="removeNumbers(grid, medium)"> Medium </button>
<button class="difficulty" type="button" onclick="removeNumbers(grid, hard)"> Hard </button>

<table class="board" onclick="boardClicked(event)">
  <tr>
    <td class="numCell" id="0,0"></td>
    <td class="numCell" id="0,1"></td> 
    <td class="numCell" id="0,2"></td>
	<td class="borderHeight" id="no"></td>
	<td class="numCell" id="0,3"></td>
	<td class="numCell" id="0,4"></td>
	<td class="numCell" id="0,5"></td>
	<td class="borderHeight" id="no"></td>
	<td class="numCell" id="0,6"></td>
	<td class="numCell" id="0,7"></td>
	<td class="numCell" id="0,8"></td>
  </tr>

  <tr>
    <td class="numCell" id="1,0"></td>
    <td class="numCell" id="1,1"></td> 
    <td class="numCell" id="1,2"></td>
	<td class="borderHeight" id="no"></td>
	<td class="numCell" id="1,3"></td>
	<td class="numCell" id="1,4"></td>
	<td class="numCell" id="1,5"></td>
	<td class="borderHeight" id="no"></td>
	<td class="numCell" id="1,6"></td>
	<td class="numCell" id="1,7"></td>
	<td class="numCell" id="1,8"></td>
  </tr>

  <tr>
    <td class="numCell" id="2,0"></td>
    <td class="numCell" id="2,1"></td> 
    <td class="numCell" id="2,2"></td>
	<td class="borderHeight" id="no"></td>
	<td class="numCell" id="2,3"></td>
	<td class="numCell" id="2,4"></td>
	<td class="numCell" id="2,5"></td>
	<td class="borderHeight" id="no"></td>
	<td class="numCell" id="2,6"></td>
	<td class="numCell" id="2,7"></td>
	<td class="numCell" id="2,8"></td>
  </tr>
  
  <tr class="border">
	<td class="border"></td>
	<td class="border"></td>
	<td class="border"></td>
	<td class="border"></td>
	<td class="border"></td>
	<td class="border"></td>
	<td class="border"></td>
	<td class="border"></td>
	<td class="border"></td>
	<td class="border"></td>
	<td class="border"></td>
  </tr>
  
  <tr>
    <td class="numCell" id="3,0"></td>
    <td class="numCell" id="3,1"></td> 
    <td class="numCell" id="3,2"></td>
	<td class="borderHeight" id="no"></td>
	<td class="numCell" id="3,3"></td>
	<td class="numCell" id="3,4"></td>
	<td class="numCell" id="3,5"></td>
	<td class="borderHeight" id="no"></td>
	<td class="numCell" id="3,6"></td>
	<td class="numCell" id="3,7"></td>
	<td class="numCell" id="3,8"></td>
  </tr>
  
  <tr>
    <td class="numCell" id="4,0"></td>
    <td class="numCell" id="4,1"></td> 
    <td class="numCell" id="4,2"></td>
	<td class="borderHeight" id="no"></td>
	<td class="numCell" id="4,3"></td>
	<td class="numCell" id="4,4"></td>
	<td class="numCell" id="4,5"></td>
	<td class="borderHeight" id="no"></td>
	<td class="numCell" id="4,6"></td>
	<td class="numCell" id="4,7"></td>
	<td class="numCell" id="4,8"></td>
  </tr>
  
  <tr>
    <td class="numCell" id="5,0"></td>
    <td class="numCell" id="5,1"></td> 
    <td class="numCell" id="5,2"></td>
	<td class="borderHeight" id="no"></td>
	<td class="numCell" id="5,3"></td>
	<td class="numCell" id="5,4"></td>
	<td class="numCell" id="5,5"></td>
	<td class="borderHeight" id="no"></td>
	<td class="numCell" id="5,6"></td>
	<td class="numCell" id="5,7"></td>
	<td class="numCell" id="5,8"></td>
  </tr>
  
  <tr class="border">
	<td class="border"></td>
	<td class="border"></td>
	<td class="border"></td>
	<td class="border"></td>
	<td class="border"></td>
	<td class="border"></td>
	<td class="border"></td>
	<td class="border"></td>
	<td class="border"></td>
	<td class="border"></td>
	<td class="border"></td>
  </tr>
  
  <tr>
    <td class="numCell" id="6,0"></td>
    <td class="numCell" id="6,1"></td> 
    <td class="numCell" id="6,2"></td>
	<td class="borderHeight" id="no"></td>
	<td class="numCell" id="6,3"></td>
	<td class="numCell" id="6,4"></td>
	<td class="numCell" id="6,5"></td>
	<td class="borderHeight" id="no"></td>
	<td class="numCell" id="6,6"></td>
	<td class="numCell" id="6,7"></td>
	<td class="numCell" id="6,8"></td>
  </tr>
  
  <tr>
    <td class="numCell" id="7,0"></td>
    <td class="numCell" id="7,1"></td> 
    <td class="numCell" id="7,2"></td>
	<td class="borderHeight" id="no"></td>
	<td class="numCell" id="7,3"></td>
	<td class="numCell" id="7,4"></td>
	<td class="numCell" id="7,5"></td>
	<td class="borderHeight" id="no"></td>
	<td class="numCell" id="7,6"></td>
	<td class="numCell" id="7,7"></td>
	<td class="numCell" id="7,8"></td>
  </tr>
  
  <tr>
    <td class="numCell" id="8,0"></td>
    <td class="numCell" id="8,1"></td> 
    <td class="numCell" id="8,2"></td>
	<td class="borderHeight" id="no"></td>
	<td class="numCell" id="8,3"></td>
	<td class="numCell" id="8,4"></td>
	<td class="numCell" id="8,5"></td>
	<td class="borderHeight" id="no"></td>
	<td class="numCell" id="8,6"></td>
	<td class="numCell" id="8,7"></td>
	<td class="numCell" id="8,8"></td>
  </tr>
</table>

<button id="b0" class="number" type="button" onclick="buttonClicked(1)">1</button>
<button id="b1" class="number" type="button" onclick="buttonClicked(2)">2</button>
<button id="b2" class="number" type="button" onclick="buttonClicked(3)">3</button>
<button id="b3" class="number" type="button" onclick="buttonClicked(4)">4</button>
<button id="b4" class="number" type="button" onclick="buttonClicked(5)">5</button>
<button id="b5" class="number" type="button" onclick="buttonClicked(6)">6</button>
<button id="b6" class="number" type="button" onclick="buttonClicked(7)">7</button>
<button id="b7" class="number" type="button" onclick="buttonClicked(8)">8</button>
<button id="b8" class="number" type="button" onclick="buttonClicked(9)">9</button>

<script>
var selectedCell = []
var lives = 3

var easy = 30
var medium = 40
var hard = 50

var check = 0
var elHelper
  
var grid = makeGrid()

var faces = [
  "&#x1f431;", //cat
  "&#x1f436;", //dog
  "&#x1F42D;", //mouse
  "&#x1f426;", //bird
  "&#x1F427;", //penguin
  "&#x1f41f;", //fish
  "&#x1F9C0;", //cheese
  "&#x1f419;", //octopus
  "&#x1f9c1;" //cupcake
]

function makeGrid() {
  return [
    [0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0, 0, 0, 0, 0, 0, 0, 0, 0]
  ]
}

var gridA = makeGrid()

function replayMoves() {
  var i = 0
  
  function drawMove() {
    if (i < moves.length) {
	  var r = moves[i][0]
	  var c = moves[i][1]
	  var x = moves[i][2]
	  
	  gridA[r][c] = x
	  
	  drawGrid(gridA)
	  
	  i++
	  
	  setTimeout(drawMove, 5)
    }
  }
  
  drawMove()
}

function drawGrid(grid) {
  for (var r = 0; r < 9; r++) {
    for (var c = 0; c < 9; c++) {
	  var cellElement = document.getElementById(r + "," + c)
	  var whichFace = grid[r][c] - 1
	  if (grid[r][c] > 0) {
	    cellElement.innerHTML = faces[whichFace]
	  }
	}
  }
  
  console.log(grid)
}

var moves = []

var randomArray = []

generateArray()

function generateArray() {
  var numberUsed = []
  for (var i = 0; i < 9; i++) {
    var done = false
	while (!done) {
	  var x = randomNum()
	  if (!numberUsed[x]) {
	    done = true
	    numberUsed[x] = true
	    randomArray.push(x)
	  }
	}
  }
}

function solveGrid(grid) {
  for (var r = 0; r < 9; r++) {
    for (var c = 0; c < 9; c++) {
	  if (grid[r][c] == 0) {
		for (var x = 1; x <= 9; x++) {
		  grid[r][c] = randomArray[x - 1]
		  moves.push([r, c, randomArray[x - 1]])
		  
		  if (isGridLegal(grid, r, c) == true) {
			if (solveGrid(grid)) {
			  return true
			}
		  }
		  
		  grid[r][c] = 0
		  moves.push([r, c, 0])
		}
		
		return false
	  }
	}
  }
  return true
}

function randomNum() {
  var x = Math.random()*100
  var x2 = Math.round(x)
  var remainder = x2 % 9
  return remainder + 1
}

function isGridLegal(grid, r, c) {
  return isGridLegalHelper(grid, r, 0, 0, 1) &&
         isGridLegalHelper(grid, 0, 1, c, 0) &&
         isSmallGridLegal(grid, r, c)		 
}

function isSmallGridLegal(grid, rIn, cIn) {
  var numbersUsed = []
  var r = Math.floor(rIn/3) * 3
  var c = Math.floor(cIn/3) * 3
  for (var i = 0; i < 3; i++) {
	var cc = c;
    for (var j = 0; j < 3; j++) {
		var x = grid[r][cc]
		if (x > 0) {
		  if (numbersUsed[x] == true) {
		    return false
		  }
		  numbersUsed[x] = true
		}
		cc = cc + 1
	}
	r = r + 1
  }
  return true
}

function removeNumbers(grid, difficulty) {
	for (i = 0; i < difficulty; i++) {
	  var r = randomNum() - 1
	  var c = randomNum() - 1
	  if (grid[r][c] == 0) {
		i = i - 1
	  } else {
	    grid[r][c] = 0
	  }
	} 
	drawGrid(grid)
}

function isGridLegalHelper(grid, startRow, deltaRow, startCol, deltaCol) {
  var row = startRow
  var col = startCol
  var numberUsed = []
  for (var i = 0; i < 9; i++) {
    var x = grid[row][col]
	if (x > 0) {
	  if (numberUsed[x] == true) {
	    return false
	  }
	  numberUsed[x] = true
    }
	row = row + deltaRow
    col = col + deltaCol
  }
  return true
}

function boardClicked(event) {
  if (event.srcElement.className != "numCell") {
    return
  }
  if (event.srcElement.innerHTML != "") {
    return
  }
  cellClicked(event.srcElement)
}

function cellClicked(cellElement) {
  if (check == 1) {
    elHelper.style.background = "white";
  }
  
  check = 1

  x = cellElement.id
  y = x.split(",")
  
  selectedCell[0] = parseInt(y[0])
  selectedCell[1] = parseInt(y[1])
  
  var el = document.getElementById(selectedCell[0] + "," + selectedCell[1])
  elHelper = el
  el.style.background = "silver";
}

function buttonClicked(num) {
  if (lives <= 0) {
	alert("You lost!")
	return
  }
  
  grid[selectedCell[0]][selectedCell[1]] = num
  
  var el = document.getElementById("livesLeft")
  
  if (isGridLegal(grid, selectedCell[0], selectedCell[1])) {
    drawGrid(grid)
	for (r = 0; r < 9; r++) {
	  for (c = 0; c < 9; c++) {
	    if (grid[r][c] == 0) {
		  return
		}
	  }
	}
	drawGrid(grid)
	el.innerHTML = "You won!"
	alert("You won!")
  } else {
    lives = lives - 1
	el.innerHTML = "Lives Left: " + lives
	alert("You lost a life!")
	grid[selectedCell[0]][selectedCell[1]] = 0
  }
}

for (i = 0; i < 9; i++) {
  var buttonEl = document.getElementById("b" + i)
  buttonEl.innerHTML = faces[i]
}

solveGrid(grid);
</script>
</body>
<style>
.board {
	border: 4px solid black;
}
.numCell {
    border: 1px solid gray;
	width: 65px;
	height: 65px;
	text-align: center;
	font-size: 200%;
	color: green;
}
.number {
	font-size: 175%;
}
.difficulty {
	font-size: 150%;
}
.border td {
	border: 2px solid black;
	height: 1px;
}
.borderHeight {
	border: 2px solid black;
	width: 1px;
}
</style>
</html>
